# AirSec
Extracting spatiotemporal features from CSI and sound and obtaining potential candidates

# audio processing

1. If the collected sound is too low, the command to increase the volume by 20 times can be used：

   ```bash
   ffmpeg -i temp.wav -filter:a "volume=20.0" temp_loud.wav
   ```

2. Run `Sound noise reduction.py` ：

   ​        Select a silent section at the end of the sound as background noise to denoise the entire sound.

3. Run `Audio processing.py` ：

   ​        Calculate short-term energy using sliding window method, and then use K-means clustering to find the point of keystroke sound occurrence.

## CSI processing

1. Run `Preprocessing.py`

   ​        Firstly, read the CSI data, fill the empty data portion with the average of its subcarriers, then extract the first 10 seconds of data for spline interpolation as input data, use a Butterworth low-pass filter to reduce noise disturbance, and finally choose to use the PCA to extract principal components or use the MRC algorithm for maximum signal-to-noise ratio.

2. Run `Split keystrokes.py`

   ​        Firstly, align the absolute time points of the CSI data and sound data, use the sliding window method to calculate the energy or dispersion of the CSI, define the portion above the threshold as the waveform generated by keystrokes, and obtain the keystroke waveform and keystroke interval time.

3. Run `Spatiotemporal feature extraction.py`

   ​        Use the DTW algorithm to calculate the distance matrix of the keystroke waveform, where if two waveforms overlap, they are marked as adjacent key presses. Then calculate the distance matrix of the keystroke interval time, and obtain the spatial and temporal features of the target sequence based on the threshold. The temporal features are sorted in ascending order of the average interval time, numbered 12345. Adjust the temporal features based on the adhesion of the spatial features to ensure that the time feature between adjacent key presses is 1.

4. Run `Candidate speculation.py`

   ​        Matching possible sequences with and without waveform overlap. When there is no waveform overlap, search for possible sequences by matching the spatiotemporal feature list normally. When there is waveform overlap, it is necessary to consider the situation of waveform overlap when matching spatial features. First, match the temporal features, search for possible numerical sequences, and then separate the overlapping and non overlapping parts of the waveform. Calculate whether the spatial features of the non overlapping parts match one by one. At the same time, if the numerical difference in the overlapping parts of the waveform is less than or equal to 1, both parts must match before being added to the candidate list.

## else

1. Production of spatiotemporal feature list：

   ​        Adjust the distance between the keys you need and the length of the target sequence, and run 'table_maker. py' to generate the form.
